{% extends 'base.html' %}
{% load static %}

{% block title %}注册 - MyBlog{% endblock %}

{% block head %}
<script src="{% static 'jquery/jquery-3.7.1.min.js' %}"></script>
<script src="{% static 'js/register.js' %}"></script>
{% endblock %}

{% block main %}
<div class="row justify-content-center">
    <div class="col-md-5 col-lg-4">
        <div class="card p-4 p-md-5 animate-fade-up">
            <h2 class="text-center mb-4 fw-bold">注册</h2>

            <form action="" method="POST">
                {% csrf_token %}

                <!-- 1. 用户名 -->
                <div class="mb-3">
                    <label class="form-label">用户名</label>
                    <!-- 添加 value="{{ request.POST.username }}" 可以在报错后保留用户输入的内容 -->
                    <input type="text" name="username" class="form-control"
                           placeholder="请输入用户名"
                           value="{{ request.POST.username|default:'' }}">
                    <!-- 错误提示 -->
                    {% if form.username.errors %}
                        <div class="text-danger small mt-1">
                            {{ form.username.errors.0 }}
                        </div>
                    {% endif %}
                </div>

                <!-- 2. 邮箱 -->
                <div class="mb-3">
                    <label class="form-label">邮箱</label>
                    <input type="email" name="email" class="form-control"
                           placeholder="请输入邮箱"
                           value="{{ request.POST.email|default:'' }}" id="email-input">
                    <!-- 错误提示 -->
                    {% if form.email.errors %}
                        <div class="text-danger small mt-1">
                            {{ form.email.errors.0 }}
                        </div>
                    {% endif %}
                </div>

                <!-- 3. 验证码 -->
                <div class="mb-3">
                    <label class="form-label">验证码</label>
                    <div class="input-group">
                        <input type="text" class="form-control" name="captcha" placeholder="请输入验证码">
                        <button class="btn btn-outline-secondary" type="button" id="captcha-btn">获取验证码</button>
                    </div>
                    <!-- 错误提示 -->
                    {% if form.captcha.errors %}
                        <div class="text-danger small mt-1">
                            {{ form.captcha.errors.0 }}
                        </div>
                    {% endif %}
                </div>

                <!-- 4. 密码 -->
                <div class="mb-3">
                    <label class="form-label">密码</label>
                    <input type="password" name="password" class="form-control" placeholder="请输入密码">
                    <!-- 错误提示 -->
                    {% if form.password.errors %}
                        <div class="text-danger small mt-1">
                            {{ form.password.errors.0 }}
                        </div>
                    {% endif %}
                </div>

                <!-- 全局错误 (如果有的话) -->
                {% if form.non_field_errors %}
                    <div class="alert alert-danger p-2 small">
                        {{ form.non_field_errors.0 }}
                    </div>
                {% endif %}

                <div class="d-grid">
                    <button class="btn btn-primary-gradient">立即注册</button>
                </div>
                <div class="text-center mt-3">
                    <small class="text-muted">已有账号？<a href="{% url 'mauth:login' %}"
                            class="text-decoration-none">立即登录</a></small>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}